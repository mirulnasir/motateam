window.Aurigma=function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=141)}([function(t,n,e){"use strict";var r=e(7),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function s(t){return void 0===t}function u(t){return null!==t&&"object"==typeof t}function a(t){if("[object Object]"!==i.call(t))return!1;var n=Object.getPrototypeOf(t);return null===n||n===Object.prototype}function c(t){return"[object Function]"===i.call(t)}function f(t,n){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var e=0,r=t.length;e<r;e++)n.call(null,t[e],e,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:u,isPlainObject:a,isUndefined:s,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:c,isStream:function(t){return u(t)&&c(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:f,merge:function t(){var n={};function e(e,r){a(n[r])&&a(e)?n[r]=t(n[r],e):a(e)?n[r]=t({},e):o(e)?n[r]=e.slice():n[r]=e}for(var r=0,i=arguments.length;r<i;r++)f(arguments[r],e);return n},extend:function(t,n,e){return f(n,(function(n,i){t[i]=e&&"function"==typeof n?r(n,e):n})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},function(t,n,e){var r,i;
/**
 * Monet.js 0.9.0-rc.1
 *
 * (c) 2012-2018 Chris Myers
 * @license Monet.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * https://monet.github.io/monet.js/
 */"undefined"!=typeof self&&self,void 0===(i="function"==typeof(r=function(){"use strict";var t={apply2:L,assign:b(Object.assign)?Object.assign:function(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0!==n[e]&&(t[e]=n[e]);return t},compose:v,curry:g(x(g),[])([]),idFunction:w,isFunction:b,noop:m,swap:x},n="Identity",e="Maybe",r="Either",i="Validation",o="List",s="NEL",u="IO",a="MonadT",c="Reader",f="Free";function p(t,n){t["@@type"]="monet.js/"+n}function h(t){return function(n){return(n["@@type"]||n.constructor["@@type"])==="monet.js/"+t}}function l(t){return function(n){var e=n["@@type"]||n.constructor&&n.constructor["@@type"];return Boolean(e)&&e.length>=t.length&&e.indexOf(t)===e.length-t.length}}function d(t){return null==t}function m(){}function y(t){return Array.prototype.slice.call(t)}function g(t,n){return function(){var e=n.concat(y(arguments));return e.length>=t.length?t.apply(null,e.slice(0,e.length)):g(t,e)}}function v(t,n){return function(e){return t(n(e))}}function b(t){return Boolean(t&&t.constructor&&t.call&&t.apply)}function w(t){return t}function S(t,n){return t===n||t!=t&&n!=n||!(!t||!n)&&!(!b(t.equals)||!b(n.equals))&&t.equals(n)}function _(t){return function(n){return S(t,n)}}function E(){return!1}function x(t){return function(n,e){return t(e,n)}}function L(t,n,e){return n.ap(t.map(g(e,[])))}function O(t,n){for(var e=t,r=n;!e.isNil&&!r.isNil;){if(!_(e.head())(r.head()))return!1;e=e.tail(),r=r.tail()}return e.isNil&&r.isNil}function I(t,n){return function t(n,e){return e.isNil?rt(e):et((function(){return t(n,e.tail())})).map(g(U,[])(n(e.head())))}(t,n).run()}function j(t,n){return t.foldRight(k)((function(t,e){return n(t)?U(t,e):e}))}function N(t,n){return function t(n,e){if(n.isNil)return rt(H());var r=n.head();return e(r)?rt($(r)):et((function(){return t(n.tail(),e)}))}(t,n).run()}function T(t,n){return function t(n,e){return n.isNil?rt(!1):S(n.head(),e)?rt(!0):et((function(){return t(n.tail(),e)}))}(t,n).run()}function U(t,n){return n.cons(t)}function P(){switch(arguments.length){case 0:return new P.fn.init;case 1:return new P.fn.init(arguments[0]);default:return new P.fn.init(arguments[0],arguments[1])}}t.List=P;var k,C=function(t,n){n.isNil||(t(n.head()),C(t,n.tail()))},A=function(t,n,e){return function n(e,r){return r.isNil?rt(e):et((function(){return n(t(e,r.head()),r.tail())}))}(n,e).run()},M=function(t,n,e){return function n(e,r){return e.isNil?rt(r):et((function(){return n(e.tail(),r)})).map((function(n){return t(e.head(),n)}))}(n,e).run()},R=function(t,n){return function t(n,e){return n.isNil?rt(e):et((function(){return t(n.tail(),e).map((function(t){return t.cons(n.head())}))}))}(t,n).run()},F=function(t,n){return t.foldRight(n.of(k))(n.map2(U))},D=function(t){return t.foldLeft(k)(x(U))};function B(t){return new Error("Cannot create an empty Non-Empty List. Passed head is "+t+".")}function q(t,n){if(d(t))throw B(t);return new q.fn.init(t,n)}P.fn=P.prototype={init:function(){var t=arguments[0],n=arguments[1];0===arguments.length?(this.isNil=!0,this.size_=0):(this.isNil=!1,this.head_=t,this.tail_=n||k,this.size_=this.tail_.size()+1),p(this,o)},of:function(t){return new P(t)},size:function(){return this.size_},equals:function(t){return(P.isOfType(t)||q.isOfType(t))&&O(this,t)},cons:function(t){return P(t,this)},snoc:function(t){return this.concat(P(t))},map:function(t){return I(t,this)},toArray:function(){return A((function(t,n){return t.push(n),t}),[],this)},toSet:function(){return new Set(this)},foldLeft:function(t){var n=this;return function(e){return A(e,t,n)}},foldRight:function(t){var n=this;return function(e){return M(e,n,t)}},append:function(t){return R(this,t)},filter:function(t){return j(this,t)},find:function(t){return N(this,t)},flatten:function(){return M(R,this,k)},flattenMaybe:function(){return this.flatMap(V.toList)},reverse:function(){return D(this)},bind:function(t){return this.map(t).flatten()},forEach:function(t){C(t,this)},contains:function(t){return T(this,t)},sequenceMaybe:function(){return F(this,V)},sequenceValidation:function(){return this.foldLeft(J(k))((function(t,n){return t.ap(n.map((function(t){return function(n){return U(t,n)}})))})).map(D)},sequenceEither:function(){return F(this,K)},sequenceIO:function(){return F(this,X)},sequenceReader:function(){return F(this,tt)},sequence:function(t){return F(this,t)},head:function(){return this.head_},headMaybe:function(){return this.isNil?H():$(this.head_)},tail:function(){return this.isNil?k:this.tail_},tails:function(){return this.isNil?P(k,k):this.tail().tails().cons(this)},ap:function(t){return n=t,this.bind((function(t){return n.map((function(n){return n(t)}))}));var n},isNEL:E,toString:function(){return this.isNil?"Nil":"List("+this.toArray().join(", ")+")"},inspect:function(){return this.toString()}},P.fn.init.prototype=P.fn,p(P,o),p(P.fn.init,o),P.isInstance=h(o),P.isOfType=l(o),P.prototype.empty=function(){return k},P.fromArray=function(t){return t.reduceRight((function(t,n){return t.cons(n)}),k)},P.from=function(t){return P.fromArray(Array.from(t))},P.of=function(t){return new P(t,k)},P.prototype.each=P.prototype.forEach,k=t.Nil=new P.fn.init,t.NEL=t.NonEmptyList=q,q.of=function(t){return q(t,k)},q.fn=q.prototype={init:function(t,n){if(d(t))throw B(t);this.isNil=!1,this.head_=t,this.tail_=d(n)?k:n,this.size_=this.tail_.size()+1,p(this,s)},equals:function(t){return P.isOfType(t)||q.isOfType(t)&&O(this,t)},cons:function(t){return q(t,this.toList())},snoc:function(t){return this.concat(q(t))},map:function(t){return q(t(this.head_),I(t,this.tail_))},bind:function(t){var n=t(this.head_);if(!n.isNEL())throw new Error("NEL.fn.bind: Passed function must return a NonEmptyList.");var e=this.tail().foldLeft(k.snoc(n.head()).append(n.tail()))((function(n,e){var r=t(e).toList();return n.snoc(r.head()).append(r.tail())}));return new q(e.head(),e.tail())},head:function(){return this.head_},tail:function(){return this.tail_},tails:function(){var t=this.toList().tails().map(q.fromList).flattenMaybe();return q(t.head(),t.tail())},toList:function(){return P(this.head_,this.tail_)},reverse:function(){if(this.tail().isNil)return this;var t=this.tail().reverse();return q(t.head(),t.tail().append(P(this.head())))},foldLeft:function(t){return this.toList().foldLeft(t)},foldRight:function(t){return this.toList().foldRight(t)},reduceLeft:function(t){return this.tail().foldLeft(this.head())(t)},filter:function(t){return j(this.toList(),t)},find:function(t){return N(this.toList(),t)},flatten:function(){return M(R,this.toList().map((function(t){return t.isNEL()?t.toList():t})),k)},flattenMaybe:function(){return this.toList().flatMap(V.toList)},contains:function(t){return T(this.toList(),t)},append:function(t){return q.fromList(this.toList().append(t.toList())).some()},cobind:function(t){return this.cojoin().map(t)},size:function(){return this.size_},forEach:function(t){return this.toList().forEach(t)},isNEL:function(){return!0},toString:function(){return"NEL("+this.toArray().join(", ")+")"},inspect:function(){return this.toString()}},q.fromList=function(t){return t.isNil?H():$(q(t.head(),t.tail()))},q.fromArray=function(t){return q.fromList(P.fromArray(t))},q.from=function(t){return q.fromList(P.from(t))},q.fn.init.prototype=q.fn,p(q,s),p(q.fn.init,s),q.isInstance=h(s),q.isOfType=l(s),q.prototype.toArray=P.prototype.toArray,q.prototype.toSet=P.prototype.toSet,q.prototype.extract=q.prototype.copure=q.prototype.head,q.prototype.cojoin=q.prototype.tails,q.prototype.coflatMap=q.prototype.mapTails=q.prototype.cobind,q.prototype.ap=P.prototype.ap;var V=t.Maybe={};V.fromFalsy=function(t){return t?V.Some(t):V.None()},V.fromNull=function(t){return d(t)?V.None():V.Some(t)},V.fromUndefined=function(t){return void 0===t?V.None():V.Some(t)},V.fromEmpty=function(t){return d(n=t)||""===n||Array.isArray(n)&&0===n.length||"object"==typeof n&&0===Object.keys(n).length?V.None():V.Some(t);var n},V.of=function(t){return $(t)};var $=V.Just=V.Some=V.some=t.Some=t.Just=function(t){return new V.fn.init(!0,t)},H=V.Nothing=V.None=V.none=t.None=t.Nothing=function(){return new V.fn.init(!1,null)};V.toList=function(t){return t.toList()},V.fn=V.prototype={init:function(t,n){if(this.isValue=t,t&&d(n))throw new Error("Can not create Some with illegal value: "+n+".");this.val=n,p(this,e)},isSome:function(){return this.isValue},isNone:function(){return!this.isSome()},bind:function(t){return this.isValue?t(this.val):this},some:function(){if(this.isValue)return this.val;throw new Error("Cannot call .some() on a None.")},orSome:function(t){return this.isValue?this.val:t},orLazy:function(t){return this.cata(t,w)},orNull:function(){return this.orSome(null)},orUndefined:function(){return this.orSome(void 0)},orElse:function(t){return this.catchMap((function(){return t}))},ap:function(t){var n=this.val;return this.isValue?t.map((function(t){return t(n)})):this},equals:function(t){return V.isOfType(t)&&this.cata((function(){return t.isNone()}),(function(n){return t.fold(!1)(_(n))}))},toArray:function(){return this.map((function(t){return[t]})).orLazy((function(){return[]}))},toSet:function(){return new Set(this)},toList:function(){return this.map(P).orLazy((function(){return k}))},toEither:function(t){return this.isSome()?Y(this.val):Z(t)},toValidation:function(t){return this.isSome()?J(this.val):G(t)},fold:function(t){var n=this;return function(e){return n.isSome()?e(n.val):t}},foldLeft:function(t){return this.toList().foldLeft(t)},foldRight:function(t){return this.toList().foldRight(t)},cata:function(t,n){return this.isSome()?n(this.val):t()},catchMap:function(t){return this.isSome()?this:t()},filter:function(t){var n=this;return n.flatMap((function(e){return t(e)?n:H()}))},orNoneIf:function(t){return t?H():this},contains:function(t){return!!this.isSome()&&S(this.val,t)},forEach:function(t){this.cata(m,t)},orElseRun:function(t){this.cata(t,m)},toString:function(){return this.isSome()?"Just("+this.val+")":"Nothing"},inspect:function(){return this.toString()}},V.prototype.orJust=V.prototype.getOrElse=V.prototype.orSome,V.prototype.just=V.prototype.some,V.prototype.isJust=V.prototype.isSome,V.prototype.isNothing=V.prototype.isNone,V.prototype.orNothingIf=V.prototype.orNoneIf,V.fn.init.prototype=V.fn,p(V,e),p(V.fn.init,e),V.isInstance=h(e),V.isOfType=l(e);var z=t.Validation={},J=z.Success=z.success=t.Success=function(t){return new z.fn.init(t,!0)},G=z.Fail=z.fail=t.Fail=function(t){return new z.fn.init(t,!1)};z.of=function(t){return J(t)},z.fn=z.prototype={init:function(t,n){this.val=t,this.isSuccessValue=n,p(this,i)},success:function(){if(this.isSuccess())return this.val;throw new Error("Cannot call success() on a Fail.")},isSuccess:function(){return this.isSuccessValue},isFail:function(){return!this.isSuccessValue},fail:function(){if(this.isSuccess())throw new Error("Cannot call fail() on a Success.");return this.val},bind:function(t){return this.isSuccess()?t(this.val):this},ap:function(t){var n=this.val;return this.isSuccess()?t.map((function(t){return t(n)})):t.isFail()?z.Fail(W.append(n,t.fail())):this},acc:function(){var t=function(){return t};return this.isSuccessValue?z.success(t):this},foldLeft:function(t){return this.toMaybe().toList().foldLeft(t)},foldRight:function(t){return this.toMaybe().toList().foldRight(t)},cata:function(t,n){return this.isSuccessValue?n(this.val):t(this.val)},catchMap:function(t){return this.isSuccess()?this:t(this.val)},swap:function(){return this.isSuccess()?G(this.val):J(this.val)},failMap:function(t){return this.isFail()?G(t(this.val)):this},bimap:function(t,n){return this.isSuccessValue?this.map(n):this.failMap(t)},forEach:function(t){this.cata(m,t)},forEachFail:function(t){this.cata(t,m)},equals:function(t){return z.isOfType(t)&&this.cata((function(n){return t.cata(_(n),E)}),(function(n){return t.cata(E,_(n))}))},toMaybe:function(){return this.isSuccess()?$(this.val):H()},toEither:function(){return(this.isSuccess()?Y:Z)(this.val)},toString:function(){return(this.isSuccess()?"Success(":"Fail(")+this.val+")"},inspect:function(){return this.toString()}},z.prototype.fold=z.prototype.cata,z.fn.init.prototype=z.fn,p(z,i),p(z.fn.init,i),z.isInstance=h(i),z.isOfType=l(i);var W=t.Semigroup={append:function(t,n){if(b(t.concat))return t.concat(n);throw new Error("Couldn't find a semigroup appender in the environment, please specify your own append function")}},Q=t.monadTransformer=t.MonadT=t.monadT=function(t){return new Q.fn.init(t)};Q.of=function(t){return Q(t)},Q.fn=Q.prototype={init:function(t){this.monad=t,p(z,a)},map:function(t){return Q(this.monad.map((function(n){return n.map(t)})))},bind:function(t){return Q(this.monad.map((function(n){return n.flatMap(t)})))},ap:function(t){return Q(this.monad.flatMap((function(n){return t.perform().map((function(t){return n.ap(t)}))})))},perform:function(){return this.monad}},Q.fn.init.prototype=Q.fn;var X=t.IO=t.io=function(t){return new X.fn.init(t)};X.of=function(t){return X((function(){return t}))},X.fn=X.prototype={init:function(t){if(!b(t))throw new Error("IO requires a function.");this.effectFn=t,p(this,u)},map:function(t){var n=this;return X((function(){return t(n.effectFn())}))},bind:function(t){var n=this;return X((function(){return t(n.effectFn()).run()}))},ap:function(t){var n=this;return t.map((function(t){return t(n.effectFn())}))},run:function(){return this.effectFn()}},X.fn.init.prototype=X.fn,p(X,u),p(X.fn.init,u),X.isInstance=h(u),X.isOfType=l(u),X.prototype.perform=X.prototype.performUnsafeIO=X.prototype.run;var K=t.Either={};K.of=function(t){return Y(t)},K.fromTry=function(t){try{return K.right(t())}catch(t){return K.left(t)}},K.fromPromise=function(t){return t.then(K.Right,K.Left)};var Y=K.Right=K.right=t.Right=function(t){return new K.fn.init(t,!0)},Z=K.Left=K.left=t.Left=function(t){return new K.fn.init(t,!1)};K.fn=K.prototype={init:function(t,n){this.isRightValue=n,this.value=t,p(this,r)},bind:function(t){return this.isRightValue?t(this.value):this},ap:function(t){var n=this;return this.isRightValue?t.map((function(t){return t(n.value)})):this},leftMap:function(t){return this.isLeft()?Z(t(this.value)):this},isRight:function(){return this.isRightValue},isLeft:function(){return!this.isRight()},right:function(){if(this.isRightValue)return this.value;throw new Error("Cannot call right() on a Left.")},left:function(){if(this.isRightValue)throw new Error("Cannot call left() on a Right.");return this.value},foldLeft:function(t){return this.toMaybe().toList().foldLeft(t)},foldRight:function(t){return this.toMaybe().toList().foldRight(t)},cata:function(t,n){return this.isRightValue?n(this.value):t(this.value)},catchMap:function(t){return this.isRight()?this:t(this.value)},swap:function(){return this.isRight()?Z(this.value):Y(this.value)},forEach:function(t){this.cata(m,t)},forEachLeft:function(t){this.cata(t,m)},equals:function(t){return K.isOfType(t)&&this.cata((function(n){return t.cata(_(n),E)}),(function(n){return t.cata(E,_(n))}))},bimap:function(t,n){return this.isRightValue?this.map(n):this.leftMap(t)},toMaybe:function(){return this.isRight()?$(this.value):H()},toValidation:function(){return this.isRight()?J(this.value):G(this.value)},toString:function(){return this.cata((function(t){return"Left("+t+")"}),(function(t){return"Right("+t+")"}))},toPromise:function(){return this.cata((function(t){return Promise.reject(t)}),(function(t){return Promise.resolve(t)}))},inspect:function(){return this.toString()}},K.prototype.fold=K.prototype.cata,K.fn.init.prototype=K.fn,p(K,r),p(K.fn.init,r),K.isInstance=h(r),K.isOfType=l(r);var tt=t.Reader=function(t){return new tt.fn.init(t)};tt.of=function(t){return tt((function(n){return t}))},tt.ask=function(){return tt(w)},tt.fn=tt.prototype={init:function(t){this.f=t,p(this,c)},run:function(t){return this.f(t)},bind:function(t){var n=this;return tt((function(e){return t(n.run(e)).run(e)}))},ap:function(t){var n=this;return t.bind((function(t){return tt((function(e){return t(n.run(e))}))}))},map:function(t){var n=this;return tt((function(e){return t(n.run(e))}))},local:function(t){var n=this;return tt((function(e){return n.run(t(e))}))}},tt.fn.init.prototype=tt.fn,p(tt,c),p(tt.fn.init,c),tt.isInstance=h(c),tt.isOfType=l(c);var nt=t.Free={},et=nt.Suspend=t.Suspend=function(t){return new nt.fn.init(t,!0)},rt=nt.Return=t.Return=function(t){return new nt.fn.init(t,!1)};function it(t){return new it.fn.init(t)}function ot(t){!function(t){t.prototype.flatMap=t.prototype.chain=t.prototype.bind,t.pure=t.unit=t.of,t.prototype.of=t.of,b(t.prototype.append)&&(t.prototype.concat=t.prototype.append),t.prototype.point=t.prototype.pure=t.prototype.unit=t.prototype.of}(t),function(t){b(t.prototype.filter)&&(t.prototype.filterNot=function(t){return this.filter((function(n){return!t(n)}))})}(t),function(t){t.prototype.join=function(){return this.flatMap(w)},t.map2=function(t){return function(n,e){return n.flatMap((function(n){return e.map((function(e){return t(n,e)}))}))}}}(t),function(t){b(t.prototype.map)||(t.prototype.map=function(t){return this.bind(v(this.of,t))})}(t),function(t){t.prototype.takeLeft=function(t){return L(this,t,(function(t,n){return t}))},t.prototype.takeRight=function(t){return L(this,t,(function(t,n){return n}))}}(t),function(t){b(t.prototype.toArray)&&(t.prototype.every=t.prototype.forall=function(t){return this.toArray().every(t)},t.prototype.exists=function(t){return this.toArray().some(t)})}(t),function(t){["equals","map","ap","chain"].filter((function(n){return b(t.prototype[n])})).forEach((function(n){t.prototype["fantasy-land/"+n]=t.prototype[n]}))}(t),function(t){b(t.prototype.toArray)&&(t.prototype[Symbol.iterator]=function(){return this.toArray()[Symbol.iterator]()})}(t),function(t){b(t.prototype.toArray)&&(t.prototype.to=function(t){return t(this)})}(t)}return nt.of=function(t){return rt(t)},nt.liftF=function(t){return b(t)?et(v(rt,t)):et(t.map(rt))},nt.fn=nt.prototype={init:function(t,n){this.isSuspend=n,n?this.functor=t:this.val=t,p(this,f)},run:function(){return this.go((function(t){return t()}))},bind:function(t){return this.isSuspend?b(this.functor)?et(v((function(n){return n.bind(t)}),this.functor)):et(this.functor.map((function(n){return n.bind(t)}))):t(this.val)},ap:function(t){return this.bind((function(n){return t.map((function(t){return t(n)}))}))},resume:function(){return this.isSuspend?Z(this.functor):Y(this.val)},go1:function(t){return function n(e){return e.resume().cata((function(e){return n(t(e))}),w)}(this)},go:function(t){for(var n=this.resume();n.isLeft();){var e=t(n.left());n=e.resume()}return n.right()}},nt.fn.init.prototype=nt.fn,p(nt,f),p(nt.fn.init,f),nt.isInstance=h(f),nt.isOfType=l(f),t.Identity=it,it.of=function(t){return new it(t)},it.fn=it.prototype={init:function(t){this.val=t,p(this,n)},bind:function(t){return t(this.val)},get:function(){return this.val},forEach:function(t){t(this.val)},equals:function(t){return it.isOfType(t)&&_(this.get())(t.get())},contains:function(t){return S(this.val,t)},toString:function(){return"Identity("+this.val+")"},inspect:function(){return this.toString()},ap:function(t){var n=this.val;return t.map((function(t){return t(n)}))},toArray:function(){return[this.get()]},toList:function(){return P(this.get(),k)},toSet:function(){return new Set(this)}},it.fn.init.prototype=it.fn,p(it,n),p(it.fn.init,n),it.isInstance=h(n),it.isOfType=l(n),ot(Q),ot(K),ot(V),ot(X),ot(q),ot(P),ot(z),ot(tt),ot(nt),ot(it),t})?r.call(n,e,n,t):r)||(t.exports=i)},function(t,n,e){t.exports=e(19)},function(t,n,e){"use strict";var r,i;!function(t){t[t.Custom=0]="Custom",t[t.Shopify=1]="Shopify",t[t.DocketManager=2]="DocketManager",t[t.Auth0Saml=3]="Auth0Saml",t[t.NopCommerce=4]="NopCommerce",t[t.WooCommerce=5]="WooCommerce"}(r||(r={}));!function(t){t[t.Template=1]="Template",t[t.OptionBasedProduct=2]="OptionBasedProduct"}(i||(i={}));e.d(n,"a",(function(){return r}))},function(t,n,e){"use strict";function r(t,n){return"string"==typeof t?i(t,n):Promise.all(t.map(t=>i(t.importData,t.url,t.isDefault)))}function i(t,n,e=!1){return new Promise((r,i)=>{const o="resolve_callback_"+Math.round(1e5*Math.random());window[o]=(...n)=>{delete window[o],document.head.removeChild(s);const e=Array.from(n);let i=t.split(",");i=i.map(t=>t.trim());const u=e.reduce((t,n,e)=>(t[i[e]]=n,t),{});r(u)};const s=document.createElement("script");s.type="module",s.onerror=t=>{console.error("Failer load script from "+n),console.error(t),i(t)},n+=(n.indexOf("?")>=0?"&":"?")+"t="+Date.now(),s.text=e?`import ${t} from '${n}'; ${o}(${t}.default || ${t} );`:`import { ${t} } from '${n}'; ${o}(${t});`,document.head.appendChild(s)})}e.d(n,"a",(function(){return r}))},function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(2),i=e.n(r);class o{constructor(t,n,e){this.apiUrl=null!=n?n:"https://customerscanvashub.com/",this.tenantId=t,this.ecommerceSystemId=null!=e?e:0,this.http=i.a.create({baseURL:null!=n?n:"https://customerscanvashub.com/",validateStatus:t=>t>=200&&t<300})}async getIntegrationInfo(t){const n=0==this.ecommerceSystemId?`/api/v1/tenants/${this.tenantId}/integrations/${t}`:`/api/v1/tenants/${this.tenantId}/integrations/${t}?storefrontId=${this.ecommerceSystemId}`,e=await this.http.get(n);return this.getDataFrom(e)}async getTemplateIntegrationInfo(t){const n=await this.http.get(`/api/v1/tenants/${this.tenantId}/integrations/template/${t}`);return this.getDataFrom(n)}async getOptionBasedProductIntegrationInfo(t,n){let e=`/api/v1/tenants/${this.tenantId}/integrations/option-based-product/${t}`;null!=n&&(e+="?productFilterId="+n);const r=await this.http.get(e);return this.getDataFrom(r)}async getToken(t,n){const e=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/gettoken`,{userGuid:t,ecommerceDomain:n,origin:window.location.origin});return this.getDataFrom(e)}async getTokenAndUserId(t,n){const e=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/getusertoken`,{userGuid:t,ecommerceDomain:n,origin:window.location.origin});return this.getDataFrom(e)}async getCcToken(t,n){const e=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/getcctoken`,{userGuid:t,ecommerceDomain:n,origin:window.location.origin});return this.getDataFrom(e)}async updateCcToken(t){await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/updatecctoken`,{userToken:t,origin:window.location.origin})}getAdditionalProducts(t,n,e){const r="https://customerscanvashub.com/"+`api/v1/tenants/${t}/integrations/GetAdditionalProducts`,i={origin:window.location.origin,ecommerceDomain:n,additionalProducts:e};return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(t=>t.json()).then(t=>{if(t.success)return t.result;throw new Error(t.error)})}getDataFrom(t){if(!this.http.defaults.validateStatus(t.status)||!t.data.success)throw new Error(`HTTP ${t.status} ${t.statusText}. ${JSON.stringify(t.data)}`);return t.data.result}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SignalList=n.SignalHandlingBase=n.SignalDispatcher=void 0;var r=e(39);Object.defineProperty(n,"SignalDispatcher",{enumerable:!0,get:function(){return r.SignalDispatcher}}),Object.defineProperty(n,"SignalHandlingBase",{enumerable:!0,get:function(){return r.SignalHandlingBase}}),Object.defineProperty(n,"SignalList",{enumerable:!0,get:function(){return r.SignalList}})},function(t,n,e){"use strict";t.exports=function(t,n){return function(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];return t.apply(n,e)}}},function(t,n,e){"use strict";var r=e(0);function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,n,e){if(!n)return t;var o;if(e)o=e(n);else if(r.isURLSearchParams(n))o=n.toString();else{var s=[];r.forEach(n,(function(t,n){null!=t&&(r.isArray(t)?n+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(i(n)+"="+i(t))})))})),o=s.join("&")}if(o){var u=t.indexOf("#");-1!==u&&(t=t.slice(0,u)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,n,e){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,n,e){"use strict";(function(n){var r=e(0),i=e(25),o={"Content-Type":"application/x-www-form-urlencoded"};function s(t,n){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=n)}var u,a={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==n&&"[object process]"===Object.prototype.toString.call(n))&&(u=e(11)),u),transformRequest:[function(t,n){return i(n,"Accept"),i(n,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(s(n,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(s(n,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};a.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(t){a.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){a.headers[t]=r.merge(o)})),t.exports=a}).call(this,e(24))},function(t,n,e){"use strict";var r=e(0),i=e(26),o=e(28),s=e(8),u=e(29),a=e(32),c=e(33),f=e(12);t.exports=function(t){return new Promise((function(n,e){var p=t.data,h=t.headers;r.isFormData(p)&&delete h["Content-Type"];var l=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",m=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";h.Authorization="Basic "+btoa(d+":"+m)}var y=u(t.baseURL,t.url);if(l.open(t.method.toUpperCase(),s(y,t.params,t.paramsSerializer),!0),l.timeout=t.timeout,l.onreadystatechange=function(){if(l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in l?a(l.getAllResponseHeaders()):null,o={data:t.responseType&&"text"!==t.responseType?l.response:l.responseText,status:l.status,statusText:l.statusText,headers:r,config:t,request:l};i(n,e,o),l=null}},l.onabort=function(){l&&(e(f("Request aborted",t,"ECONNABORTED",l)),l=null)},l.onerror=function(){e(f("Network Error",t,null,l)),l=null},l.ontimeout=function(){var n="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(n=t.timeoutErrorMessage),e(f(n,t,"ECONNABORTED",l)),l=null},r.isStandardBrowserEnv()){var g=(t.withCredentials||c(y))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;g&&(h[t.xsrfHeaderName]=g)}if("setRequestHeader"in l&&r.forEach(h,(function(t,n){void 0===p&&"content-type"===n.toLowerCase()?delete h[n]:l.setRequestHeader(n,t)})),r.isUndefined(t.withCredentials)||(l.withCredentials=!!t.withCredentials),t.responseType)try{l.responseType=t.responseType}catch(n){if("json"!==t.responseType)throw n}"function"==typeof t.onDownloadProgress&&l.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){l&&(l.abort(),e(t),l=null)})),p||(p=null),l.send(p)}))}},function(t,n,e){"use strict";var r=e(27);t.exports=function(t,n,e,i,o){var s=new Error(t);return r(s,n,e,i,o)}},function(t,n,e){"use strict";var r=e(0);t.exports=function(t,n){n=n||{};var e={},i=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],u=["validateStatus"];function a(t,n){return r.isPlainObject(t)&&r.isPlainObject(n)?r.merge(t,n):r.isPlainObject(n)?r.merge({},n):r.isArray(n)?n.slice():n}function c(i){r.isUndefined(n[i])?r.isUndefined(t[i])||(e[i]=a(void 0,t[i])):e[i]=a(t[i],n[i])}r.forEach(i,(function(t){r.isUndefined(n[t])||(e[t]=a(void 0,n[t]))})),r.forEach(o,c),r.forEach(s,(function(i){r.isUndefined(n[i])?r.isUndefined(t[i])||(e[i]=a(void 0,t[i])):e[i]=a(void 0,n[i])})),r.forEach(u,(function(r){r in n?e[r]=a(t[r],n[r]):r in t&&(e[r]=a(void 0,t[r]))}));var f=i.concat(o).concat(s).concat(u),p=Object.keys(t).concat(Object.keys(n)).filter((function(t){return-1===f.indexOf(t)}));return r.forEach(p,c),e}},function(t,n,e){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));class r{constructor(t){this.getCookies=()=>{const t=this._doc.cookie;return t?t.split(";").reduce((t,n,e,r)=>{const i=n.split("=");if(2!==i.length)throw new Error("Each cookie should be an equal sign separated string.");return t[i[0].trim()]=i[1],t},{}):{}},this._doc=t}getLanguage(){const t=this._doc.querySelector("html").getAttribute("lang");return Boolean(t)?t.substr(0,2):"en"}}},function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(2),i=e.n(r);class o{constructor({url:t,tenantId:n,http:e}){this.apiUrl=t,this.tenantId=n,this.http=null!=e?e:i.a}async warmUp(t,n,e){for(let r=0;r<t;r++){const i=await this.http.get(this.apiUrl+"/ping");switch(i.status){case 200:case 201:case 204:return!0;case 503:if(r<t-1){const t=new Promise(t=>setTimeout(t,1e3*n));Boolean(e)&&e(),await t}break;default:throw new Error(`Unexpected response from service: HTTP ${i.status} ${i.statusText}`)}}return!1}async post(t){return(await this.http.post(`${this.apiUrl}/tenants/${this.tenantId}/projects/create`,t,{headers:{"Content-Type":"application/json"}})).data}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Subscription=void 0;var r=function(){function t(t,n){this.handler=t,this.isOnce=n,this.isExecuted=!1}return t.prototype.execute=function(t,n,e){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;t?setTimeout((function(){r.apply(n,e)}),1):r.apply(n,e)}},t}();n.Subscription=r},function(t,n,e){"use strict";var r=e(5),i=e(4),o=e(16);class s{static process(t){switch(typeof t){case"string":try{return JSON.parse(t)}catch(n){return t}case"object":const n={};for(const[e,r]of Object.entries(t))n[e]=s.process(r);return n;default:return t}}}class u{constructor(t){Object.assign(this,t)}}class a{constructor(t,n,e,r){this.ecommerceService=n,this.driverLoader=e,this.input=t,this.additionalProducts=r}async getDriver(){return await this.prepareDriver()}async prepareDriver(){const[t,n]=this.prepareSettings(),e=(await Object(i.a)([{importData:"editor",url:this.input.uiFrameworkUrl+"/editor.js",isDefault:!0}]))[0].editor,r=this.ecommerceService.getUser();r.tokenId=this.input.ccToken;const o=await this.driverLoader.init([this.ecommerceService.productModel].concat(this.additionalProducts),e,n,t,this.ecommerceService.getBackToEditorData().orNull(),this.ecommerceService.quantity,r,this.ecommerceService.backOffice),u=this.input.attributes.map(t=>({name:t.name,value:s.process(t.value)}));return o.products.current.attributes.push(...u),o}prepareSettings(){var t;const n=this.ecommerceService.getPluginSettings();n.token=this.input.token,n.tenantId=this.input.tenantId,n.editorUrl=this.input.customersCanvasUrl,n.customersCanvasBaseUrl=this.input.customersCanvasUrl,n.customersCanvasUrl=this.input.customersCanvasUrl;const e=Object.assign({},this.input.config);return null!==(t=e.vars)&&void 0!==t||(e.vars={}),e.vars.backOfficeUserId=this.input.tokenUserId,e.vars.token=this.input.token,e.vars.unitId=this.input.tenantId,e.vars.tenantId=this.input.tenantId,[n,e]}}var c=e(6);e.d(n,"a",(function(){return f}));class f{constructor({container:t,ecommerceService:n}){this.container=t,this.ecommerceService=n,this.driver=null,this.projectBuffer=null,this.onCreating=new c.SignalDispatcher,this.onCreated=new c.SignalDispatcher}async create(t=!0){this.onCreating.dispatch();const[n,e]=await async function(t,n=!0){var e,s,c;const f=new r.a(t.tenantId,t.backofficeUrl),p=await f.getIntegrationInfo(String(t.getProductId())),h=new o.a({url:p.projectsBufferUrl,tenantId:t.tenantId});!1!==n&&h.warmUp(5,3,()=>console.warn("Cannot ping project buffer... Retrying in 3 seconds.")).then(t=>{t||console.warn("Project buffer was not warmed up.")});const l=(await Object(i.a)("ecommerceDriver",`${p.uiFrameworkUrl}/drivers/${t.driverFilename}`)).ecommerceDriver,d=await f.getTokenAndUserId(t.customerAuth.id,t.domain);t.backOffice={storefrontId:null!==(e=p.ecommerceSystemId)&&void 0!==e?e:"",apiGatewayUrl:null!==(s=p.apiGatewayUrl)&&void 0!==s?s:"",backOfficeUrl:null!==(c=t.backofficeUrl)&&void 0!==c?c:"https://customerscanvashub.com/",assetStorageUrl:p.assetStorageUrl,assetProcessorUrl:p.assetProcessorUrl,designAtomsApiUrl:p.designAtomsApiUrl,userId:d.userId,token:d.token,tenantId:t.tenantId};const m=new u({attributes:p.templateAttributes.slice(),config:(t=>{var n;return null!==(n=t.config)&&void 0!==n?n:t})(JSON.parse(p.config)),customersCanvasUrl:p.customerCanvasUrl,uiFrameworkUrl:p.uiFrameworkUrl,tenantId:t.tenantId,token:d.token,tokenUserId:d.userId,ccToken:await f.getCcToken(t.getUser().id,t.domain||window.location.origin)});let y=[];m.config.additionalProducts&&m.config.additionalProducts.length>0&&(y=await f.getAdditionalProducts(t.tenantId,window.location.origin,m.config.additionalProducts));const g=new a(m,t,l,y);return[await g.getDriver(),h]}(this.ecommerceService,t);return this.driver=n,this.projectBuffer=e,this.ecommerceService.addEditorExitHandler(this),await this.renderEditor(),this.onCreated.dispatch(),this.driver}async addProjectHandler(t){this.ecommerceService.addProjectHandler(t)}async renderEditor(){const t=document.createElement("div");return t.style.height="100%",this.container.appendChild(t),this.driver.products.current.renderEditor(t,this.ecommerceService.themeSettings),this.syncronizeOptions(),new Promise((t,n)=>{this.container.addEventListener("load",t),this.container.addEventListener("error",n)})}syncronizeOptions(){this.driver.orders.current.quantity=this.ecommerceService.quantity;this.ecommerceService.getSelectedVariantId().isJust()&&"function"==typeof this.driver.orders.current.updateVariant&&this.driver.orders.current.updateVariant(this.ecommerceService.getSelectedVariantId().just())}}},function(t,n,e){"use strict";var r=e(0),i=e(7),o=e(20),s=e(13);function u(t){var n=new o(t),e=i(o.prototype.request,n);return r.extend(e,o.prototype,n),r.extend(e,n),e}var a=u(e(10));a.Axios=o,a.create=function(t){return u(s(a.defaults,t))},a.Cancel=e(14),a.CancelToken=e(34),a.isCancel=e(9),a.all=function(t){return Promise.all(t)},a.spread=e(35),a.isAxiosError=e(36),t.exports=a,t.exports.default=a},function(t,n,e){"use strict";var r=e(0),i=e(8),o=e(21),s=e(22),u=e(13);function a(t){this.defaults=t,this.interceptors={request:new o,response:new o}}a.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=u(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=[s,void 0],e=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){n.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){n.push(t.fulfilled,t.rejected)}));n.length;)e=e.then(n.shift(),n.shift());return e},a.prototype.getUri=function(t){return t=u(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){a.prototype[t]=function(n,e){return this.request(u(e||{},{method:t,url:n,data:(e||{}).data}))}})),r.forEach(["post","put","patch"],(function(t){a.prototype[t]=function(n,e,r){return this.request(u(r||{},{method:t,url:n,data:e}))}})),t.exports=a},function(t,n,e){"use strict";var r=e(0);function i(){this.handlers=[]}i.prototype.use=function(t,n){return this.handlers.push({fulfilled:t,rejected:n}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(n){null!==n&&t(n)}))},t.exports=i},function(t,n,e){"use strict";var r=e(0),i=e(23),o=e(9),s=e(10);function u(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return u(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(n){delete t.headers[n]})),(t.adapter||s.adapter)(t).then((function(n){return u(t),n.data=i(n.data,n.headers,t.transformResponse),n}),(function(n){return o(n)||(u(t),n&&n.response&&(n.response.data=i(n.response.data,n.response.headers,t.transformResponse))),Promise.reject(n)}))}},function(t,n,e){"use strict";var r=e(0);t.exports=function(t,n,e){return r.forEach(e,(function(e){t=e(t,n)})),t}},function(t,n){var e,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var a,c=[],f=!1,p=-1;function h(){f&&a&&(f=!1,a.length?c=a.concat(c):p=-1,c.length&&l())}function l(){if(!f){var t=u(h);f=!0;for(var n=c.length;n;){for(a=c,c=[];++p<n;)a&&a[p].run();p=-1,n=c.length}a=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function d(t,n){this.fun=t,this.array=n}function m(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];c.push(new d(t,n)),1!==c.length||f||u(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,n,e){"use strict";var r=e(0);t.exports=function(t,n){r.forEach(t,(function(e,r){r!==n&&r.toUpperCase()===n.toUpperCase()&&(t[n]=e,delete t[r])}))}},function(t,n,e){"use strict";var r=e(12);t.exports=function(t,n,e){var i=e.config.validateStatus;e.status&&i&&!i(e.status)?n(r("Request failed with status code "+e.status,e.config,null,e.request,e)):t(e)}},function(t,n,e){"use strict";t.exports=function(t,n,e,r,i){return t.config=n,e&&(t.code=e),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,n,e){"use strict";var r=e(0);t.exports=r.isStandardBrowserEnv()?{write:function(t,n,e,i,o,s){var u=[];u.push(t+"="+encodeURIComponent(n)),r.isNumber(e)&&u.push("expires="+new Date(e).toGMTString()),r.isString(i)&&u.push("path="+i),r.isString(o)&&u.push("domain="+o),!0===s&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,n,e){"use strict";var r=e(30),i=e(31);t.exports=function(t,n){return t&&!r(n)?i(t,n):n}},function(t,n,e){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,n,e){"use strict";t.exports=function(t,n){return n?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t}},function(t,n,e){"use strict";var r=e(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var n,e,o,s={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),n=r.trim(t.substr(0,o)).toLowerCase(),e=r.trim(t.substr(o+1)),n){if(s[n]&&i.indexOf(n)>=0)return;s[n]="set-cookie"===n?(s[n]?s[n]:[]).concat([e]):s[n]?s[n]+", "+e:e}})),s):s}},function(t,n,e){"use strict";var r=e(0);t.exports=r.isStandardBrowserEnv()?function(){var t,n=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");function i(t){var r=t;return n&&(e.setAttribute("href",r),r=e.href),e.setAttribute("href",r),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return t=i(window.location.href),function(n){var e=r.isString(n)?i(n):n;return e.protocol===t.protocol&&e.host===t.host}}():function(){return!0}},function(t,n,e){"use strict";var r=e(14);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(t){n=t}));var e=this;t((function(t){e.reason||(e.reason=new r(t),n(e.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(n){t=n})),cancel:t}},t.exports=i},function(t,n,e){"use strict";t.exports=function(t){return function(n){return t.apply(null,n)}}},function(t,n,e){"use strict";t.exports=function(t){return"object"==typeof t&&!0===t.isAxiosError}},function(t,n,e){"use strict";function r(){var t;let n=(new Date).getTime(),e=null!==(t=performance&&performance.now&&1e3*performance.now())&&void 0!==t?t:0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{var r=16*Math.random();return n>0?(r=(n+r)%16|0,n=Math.floor(n/16)):(r=(e+r)%16|0,e=Math.floor(e/16)),("x"===t?r:3&r|8).toString(16)})}function i(t){return t.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i)}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return i}))},,function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0}),n.SignalHandlingBase=n.SignalList=n.SignalDispatcher=void 0;var o=e(40),s=function(t){function n(){return t.call(this)||this}return i(n,t),n.prototype.dispatch=function(){this._dispatch(!1,this,arguments)},n.prototype.dispatchAsync=function(){this._dispatch(!0,this,arguments)},n.prototype.asEvent=function(){return t.prototype.asEvent.call(this)},n}(o.DispatcherBase);n.SignalDispatcher=s;var u=function(t){function n(){return t.call(this)||this}return i(n,t),n.prototype.createDispatcher=function(){return new s},n}(o.EventListBase);n.SignalList=u;var a=function(){function t(){this._events=new u}return Object.defineProperty(t.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),t.prototype.one=function(t,n){this._events.get(t).one(n)},t.prototype.has=function(t,n){return this._events.get(t).has(n)},t.prototype.subscribe=function(t,n){this._events.get(t).subscribe(n)},t.prototype.sub=function(t,n){this.subscribe(t,n)},t.prototype.unsubscribe=function(t,n){this._events.get(t).unsubscribe(n)},t.prototype.unsub=function(t,n){this.unsubscribe(t,n)},t}();n.SignalHandlingBase=a},function(t,n,e){"use strict";
/*!
 * Strongly Typed Events for TypeScript - Core
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(n,"__esModule",{value:!0}),n.Subscription=n.EventListBase=n.DispatcherWrapper=n.DispatcherBase=void 0;var r=e(41);Object.defineProperty(n,"DispatcherBase",{enumerable:!0,get:function(){return r.DispatcherBase}}),Object.defineProperty(n,"DispatcherWrapper",{enumerable:!0,get:function(){return r.DispatcherWrapper}}),Object.defineProperty(n,"EventListBase",{enumerable:!0,get:function(){return r.EventListBase}});var i=e(17);Object.defineProperty(n,"Subscription",{enumerable:!0,get:function(){return i.Subscription}})},function(t,n,e){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),i=0;for(n=0;n<e;n++)for(var o=arguments[n],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r};Object.defineProperty(n,"__esModule",{value:!0}),n.DispatcherWrapper=n.EventListBase=n.DispatcherBase=void 0;var i=e(42),o=e(17),s=function(){function t(){this._wrap=new a(this),this._subscriptions=new Array}return Object.defineProperty(t.prototype,"count",{get:function(){return this._subscriptions.length},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){var n=this;return t&&this._subscriptions.push(new o.Subscription(t,!1)),function(){n.unsubscribe(t)}},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.one=function(t){var n=this;return t&&this._subscriptions.push(new o.Subscription(t,!0)),function(){n.unsubscribe(t)}},t.prototype.has=function(t){return!!t&&this._subscriptions.some((function(n){return n.handler==t}))},t.prototype.unsubscribe=function(t){if(t)for(var n=0;n<this._subscriptions.length;n++)if(this._subscriptions[n].handler==t){this._subscriptions.splice(n,1);break}},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype._dispatch=function(t,n,e){for(var o=this,s=function(r){var s=new i.EventManagement((function(){return o.unsub(r.handler)})),a=Array.prototype.slice.call(e);if(a.push(s),r.execute(t,n,a),u.cleanup(r),!t&&s.propagationStopped)return"break"},u=this,a=0,c=r(this._subscriptions);a<c.length;a++){if("break"===s(c[a]))break}},t.prototype.cleanup=function(t){if(t.isOnce&&t.isExecuted){var n=this._subscriptions.indexOf(t);n>-1&&this._subscriptions.splice(n,1)}},t.prototype.asEvent=function(){return this._wrap},t.prototype.clear=function(){this._subscriptions.splice(0,this._subscriptions.length)},t}();n.DispatcherBase=s;var u=function(){function t(){this._events={}}return t.prototype.get=function(t){var n=this._events[t];return n||(n=this.createDispatcher(),this._events[t]=n,n)},t.prototype.remove=function(t){delete this._events[t]},t}();n.EventListBase=u;var a=function(){function t(t){this._subscribe=function(n){return t.subscribe(n)},this._unsubscribe=function(n){return t.unsubscribe(n)},this._one=function(n){return t.one(n)},this._has=function(n){return t.has(n)},this._clear=function(){return t.clear()},this._count=function(){return t.count}}return Object.defineProperty(t.prototype,"count",{get:function(){return this._count()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){return this._subscribe(t)},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.unsubscribe=function(t){this._unsubscribe(t)},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype.one=function(t){return this._one(t)},t.prototype.has=function(t){return this._has(t)},t.prototype.clear=function(){this._clear()},t}();n.DispatcherWrapper=a},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.EventManagement=void 0;var r=function(){function t(t){this.unsub=t,this.propagationStopped=!1}return t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();n.EventManagement=r},,,,,,function(t,n,e){"use strict";e.d(n,"a",(function(){return r}));class r{static fromCart(t,n){const e=new r;return e.line_items=t.lineItems.map(t=>{var e,r,i,o,s;return{productId:t.productId,key:n(t),quantity:t.quantity,group:null===(e=t.props)||void 0===e?void 0:e._group,userId:null===(r=t.props)||void 0===r?void 0:r._userId,stateId:null===(i=t.props)||void 0===i?void 0:i._stateId,hidden:null===(o=t.props)||void 0===o?void 0:o._hidden,fields:null===(s=t.props)||void 0===s?void 0:s._fields,properties:t.props}}),e}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,n,e){"use strict";e.r(n);var r=e(18),i=e(1),o=e(15),s=e(37);class u{constructor(t){this.driver=t}applyProjectToCart(t,n){this.driver.cart.lineItems.forEach((e,r)=>{e.data.itemId=t.line_items[r].key,e.data.projectId=n})}}var a=e(48),c=e(3);class f{constructor({backofficeUrl:t,tenantId:n,customerId:e,customerSignature:r,shopName:s,product:u}){this._projectHandlers=[],this.getPluginSettings=()=>({language:new o.a(document).getLanguage(),currency:this.getCurrency(),shopifyBaseUrl:new URL(`${window.location.protocol}\\${this.domain}`).toString()}),this.getBackToEditorData=()=>this.getBackToEditorDataFromQueryString(),this.getProductId=()=>this._product.id,this.getSelectedVariantId=()=>this.getVariantIdFromForm(this.findVariantForm()).catchMap(()=>this.getVariantIdFromShopifyAnalytics()).catchMap(()=>this.getVariantIdFromQueryString()).map(t=>Number(t)),this.generateUserId=()=>i.Maybe.fromFalsy(this._customerId).cata(()=>this.getCurrentSessionId(),t=>this.buildCustomersCanvasUserId(this.domain,t)),this.findVariantForm=()=>document.querySelector("form[action='/cart/add']"),this._backofficeUrl=t,this._tenantId=n,this._customerId=e,this._customerSignature=r,this._shopName=s,this._product=u,this._settings=this.getPluginSettings(),this.ecommerceSystemType=c.a.Shopify}get backofficeUrl(){return this._backofficeUrl}get tenantId(){return this._tenantId}get domain(){return this._shopName}get driverFilename(){return"shopify-driver.js"}get customerAuth(){return{id:this.generateUserId(),signature:this._customerSignature}}get productModel(){return this._product}get quantity(){return this.getQuantityFromForm(this.findVariantForm()).getOrElse(1)}addProjectHandler(t){this._projectHandlers.push(t)}addEditorExitHandler(t){t.driver.cart.onSubmitting.subscribe(async()=>{const n=a.a.fromCart(t.driver.cart,t=>Object(s.a)()),e=await t.projectBuffer.post(n);new u(t.driver).applyProjectToCart(n,e)})}getCurrency(){var t,n,e,r,i,o;return null!==(o=null!==(e=null===(n=null===(t=null===window||void 0===window?void 0:window.Shopify)||void 0===t?void 0:t.currency)||void 0===n?void 0:n.active)&&void 0!==e?e:null===(i=null===(r=null===window||void 0===window?void 0:window.ShopifyAnalytics)||void 0===r?void 0:r.meta)||void 0===i?void 0:i.currency)&&void 0!==o?o:"USD"}updatePluginSettings(t){this._settings.editorUrl=t.editorUrl,this._settings.shopifyBaseUrl=t.shopifyBaseUrl}getUser(){return{id:this.generateUserId(),tokenId:""}}getCurrentSessionId(){const t=new o.a(document).getCookies();return"shopify_"+(t._shopify_y||t._y||t._shopify_s||t._s||t.__ssid||Object(s.a)())}buildCustomersCanvasUserId(t,n){return`shopify_${(null!=t?t:"").split(".")[0]}_${n}`}getQuantityFromForm(t){return i.Maybe.fromNull(t).map(t=>new window.FormData(t)).flatMap(t=>i.Maybe.fromNull(t.get("quantity"))).map(t=>Number(t))}getVariantIdFromForm(t){return i.Maybe.fromNull(t).map(t=>new window.FormData(t)).map(t=>t.get("id")).map(t=>String(t))}getVariantIdFromShopifyAnalytics(){return i.Maybe.fromFalsy(window.ShopifyAnalytics).flatMap(({meta:t})=>i.Maybe.fromFalsy(t)).flatMap(({selectedVariantId:t})=>i.Maybe.fromFalsy(t)).map(t=>String(t))}getVariantIdFromQueryString(){const t=new URLSearchParams(window.location.search);return i.Maybe.of(t).flatMap(t=>i.Maybe.fromNull(t.get("variant")))}getBackToEditorDataFromQueryString(){const t=new URLSearchParams(window.location.search);return i.Maybe.of(t).map(t=>({key:t.get("key"),snapshot:t.get("snapshot")})).flatMap(t=>null!==t.key&&null!==t.snapshot?i.Maybe.of(t):i.Maybe.Nothing())}}e.d(n,"UIFrameworkEditor",(function(){return r.a})),e.d(n,"ShopifyService",(function(){return f}))}]);